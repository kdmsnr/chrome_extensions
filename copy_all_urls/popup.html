<html>
<head>
<script type="text/javascript"><!--

    function copyAllUrls() {
        var format = localStorage["copy_all_urls_format"];
        if (!format) { format = "%text% %url%"; }
        chrome.windows.getCurrent(function(win) {
            chrome.tabs.getAllInWindow(win.id, function(tabs) {
                var result = "";
                for (i = 0; i < tabs.length; i++) {
                    result += format.replace(/%text%/g, tabs[i].title).
                              replace(/%url%/g, tabs[i].url);
                    result += '\n';
                }
                var target = document.getElementById('target');
                target.value = result;
                target.select();
                document.execCommand("copy", false, null);
            });
        });
    }

    copyAllUrls();

//--></script>
</head>
<body>
<textarea id="target">
</textarea>
</body>
</html>
